---
title: 'Session 2: Answers'
author: "Robert Smith, Paul Schneider & Sarah Bates"
date: "10/09/2020"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Exercises

### Exercise 1: Create a more complex model

In this exercise you'll create a model with more inputs and integrate a function to generate the output: 

a) Create a new Shiny app with the title "more complex model" and a sidebar Layout

```{r}

library(shiny)

#================================================================
#                   Create User Interface
#================================================================

ui <- fluidPage(    # create user interface using fluidpage function
  
  titlePanel("More complex model"),   # title of app
  
  # SIDEBAR
  sidebarLayout(    # indicates layout is going to be a sidebar-layout
    
    sidebarPanel( # open sidebar panel
      
    ),  # close sidebarPanel
    
    mainPanel(                                # open main panel
   
    ) # close mainpanel    
    
  ) # close sidebarlayout
  
) # close UI fluidpage


#================================================================
#                     Create Server Function
#================================================================

server <- function(input, output){   # server = function with two inputs
  
          
  
} # Server end
```

![App with title](Images/Screenshots/More complex model title.png){width=300 height=300px}

b) Create a function, before the user interface fucntion, that calculates the difference between the maximum and the mean of the three numbers (x,y,z). 

```{r}

fun_shiny <- function(x,y,z){
  
  max_minus_mean = max(c(x,y,z)) - mean(c(x,y,z))
  
  max_minus_mean
  
}

```

c) In the sidebar panel add five inputs:  
    i) a numeric input, w, with initial value of 200 and a range of 0 - 400
    ii) numeric input, x, with initial value of 1000 and a range of 0 - 2000 
    iii) slider input, y, with a initial value of 25 and a range on 10 - 80 (Hint: use sliderInput function)
    iv) select input, z, that enables the user to select from three treatment options (Hint: use selectInput function)
    v) run model action button
    
```{r}


#================================================================
#                          Simple Function                      
#================================================================

fun_shiny <- function(x,y,z){
  
  max_minus_mean = max(c(x,y,z)) - mean(c(x,y,z))
  
  max_minus_mean
  
}



#================================================================
#                   Create User Interface
#================================================================

ui <- fluidPage(    # create user interface using fluidpage function
  
  titlePanel("More complex model"),   # title of app
  
  # SIDEBAR
  sidebarLayout(    # indicates layout is going to be a sidebar-layout
    
    sidebarPanel( # open sidebar panel
      
      # i)
      numericInput(inputId = "SI_X",      # id of input, used in server
                   label = "Number X",  # label next to numeric input
                   value = 200,               # initial value
                   min = 0,                   # minimum value allowed
                   max = 400),                # maximum value allowed
      
      # ii)
      numericInput(inputId = "SI_Y",      # id of input, used in server
                   label = "Number Y",        # label next to numeric input
                   value = 1000,              # initial value
                   min = 0,                   # minimum value allowed
                   max = 2000),                # maximum value allowed
      
      # iii)
      sliderInput(inputId = "SI_Z",  # id of input, used in server
                  label = "Number Z",      # label next to numeric input
                  value = 25,                 # initial value
                  min = 10,                   # minimum value allowed
                  max = 80),                  # maximum value allowed
      
           # iii)
      selectInput(inputId = "treatment",  # id of input, used in server
                  label = "Treatment",      # label next to input
                  list("A", "B", "C")),     # list of options
 
      # v)
      actionButton(inputId = "run_model",     # id of action button, used in server
                   label   = "Run model")     # action button label (on button)
      
    ),  # close sidebarPanel
    
    mainPanel(                                # open main panel
    
      
    ) # close mainpanel    
    
  ) # close sidebarlayout
  
) # close UI fluidpage


#================================================================
#                     Create Server Function
#================================================================

server <- function(input, output){   # server = function with two inputs
  

} # Server end



```
 
![App with inputs](Images/Screenshots/Complex model with inputs.png){width=300 height=300px}    
    
d) Add the title "Results" to the main panel (Hint: you can use h1-6 to select different header levels, e.g. h1("Main Title"))

```{r}


#================================================================
#                   Create User Interface
#================================================================

ui <- fluidPage(    # create user interface using fluidpage function
  
  titlePanel("More complex model"),   # title of app
  
  # SIDEBAR
  sidebarLayout(    # indicates layout is going to be a sidebar-layout
    
    sidebarPanel( # open sidebar panel
      
      # i)
      numericInput(inputId = "SI_X",      # id of input, used in server
                   label = "Number X",  # label next to numeric input
                   value = 200,               # initial value
                   min = 0,                   # minimum value allowed
                   max = 400),                # maximum value allowed
      
      # ii)
      numericInput(inputId = "SI_Y",      # id of input, used in server
                   label = "Number Y",        # label next to numeric input
                   value = 1000,              # initial value
                   min = 0,                   # minimum value allowed
                   max = 2000),                # maximum value allowed
      
      # iii)
      sliderInput(inputId = "SI_Z",  # id of input, used in server
                  label = "Number Z",      # label next to numeric input
                  value = 25,                 # initial value
                  min = 10,                   # minimum value allowed
                  max = 80),                  # maximum value allowed
      
           # iii)
      selectInput(inputId = "treatment",  # id of input, used in server
                  label = "Treatment",      # label next to input
                  list("A", "B", "C")),     # list of options
 
      # v)
      actionButton(inputId = "run_model",     # id of action button, used in server
                   label   = "Run model")     # action button label (on button)
      
    ),  # close sidebarPanel
    
    mainPanel(                                # open main panel
      
    h3("Results")                   # heading (results)        
      
      
    ) # close mainpanel    
    
  ) # close sidebarlayout
  
) # close UI fluidpage

```

![App with inputs and Results title](Images/Screenshots/complex with results title.png){width=300 height=300px}   

e) Add a text output to the main panel in the user interface

```{r}

#================================================================
#                   Create User Interface
#================================================================

ui <- fluidPage(    # create user interface using fluidpage function
  
  titlePanel("More complex model"),   # title of app
  
  # SIDEBAR
  sidebarLayout(    # indicates layout is going to be a sidebar-layout
    
    sidebarPanel( # open sidebar panel
      
      # i)
      numericInput(inputId = "SI_X",      # id of input, used in server
                   label = "Number X",  # label next to numeric input
                   value = 200,               # initial value
                   min = 0,                   # minimum value allowed
                   max = 400),                # maximum value allowed
      
      # ii)
      numericInput(inputId = "SI_Y",      # id of input, used in server
                   label = "Number Y",        # label next to numeric input
                   value = 1000,              # initial value
                   min = 0,                   # minimum value allowed
                   max = 2000),                # maximum value allowed
      
      # iii)
      sliderInput(inputId = "SI_Z",  # id of input, used in server
                  label = "Number Z",      # label next to numeric input
                  value = 25,                 # initial value
                  min = 10,                   # minimum value allowed
                  max = 80),                  # maximum value allowed
      
      # iii)
      selectInput(inputId = "treatment",  # id of input, used in server
                  label = "Treatment",      # label next to input
                  list("A", "B", "C")),     # list of options
      
      # v)
      actionButton(inputId = "run_model",     # id of action button, used in server
                   label   = "Run model")     # action button label (on button)
      
    ),  # close sidebarPanel
    
    mainPanel(                                # open main panel
      
      h3("Results") ,                  # heading (results)        
      
      textOutput(outputId = "printvalue")                    # text output            
      
      
    ) # close mainpanel    
    
  ) # close sidebarlayout
  
) # close UI fluidpage


```

f) Change the server function so that it returns the difference between the maximum and mean of three inputs (x,y,z) when the action button is selected (Hint: use the function created in part b, and the script we created previously, saved as script 2, as a template for this section)

```{r}

#================================================================
#                          Simple Function                      
#================================================================

fun_shiny <- function(x,y,z){
  
  max_minus_mean = max(c(x,y,z)) - mean(c(x,y,z))
  
  max_minus_mean
  
}


#================================================================
#                   Create User Interface
#================================================================

ui <- fluidPage(    # create user interface using fluidpage function
  
  titlePanel("More complex model"),   # title of app
  
  # SIDEBAR
  sidebarLayout(    # indicates layout is going to be a sidebar-layout
    
    sidebarPanel( # open sidebar panel
      
      numericInput(inputId = "SI_X",      # id of input, used in server
                   label = "Number X",  # label next to numeric input
                   value = 200,               # initial value
                   min = 0,                   # minimum value allowed
                   max = 400),                # maximum value allowed
      
      numericInput(inputId = "SI_Y",      # id of input, used in server
                   label = "Number Y",        # label next to numeric input
                   value = 1000,              # initial value
                   min = 0,                   # minimum value allowed
                   max = 400),                # maximum value allowed
      
      sliderInput(inputId = "SI_Z",  # id of input, used in server
                  label = "Number Z",      # label next to numeric input
                  value = 25,                 # initial value
                  min = 10,                   # minimum value allowed
                  max = 80),                  # maximum value allowed
      
      
      actionButton(inputId = "run_model",     # id of action button, used in server
                   label   = "Run model")     # action button label (on button)
      
    ),  # close sidebarPanel
    
    mainPanel(                                # open main panel
      
      h3("Results"),                    # heading (results)                
      
      textOutput(outputId = "printvalue")                    # heading (results table)                
      
      
    ) # close mainpanel    
    
  ) # close sidebarlayout
  
) # close UI fluidpage


#================================================================
#                     Create Server Function
#================================================================

server <- function(input, output){   # server = function with two inputs
  
  
  
  observeEvent(input$run_model,       # when action button pressed ...
               ignoreNULL = F, {
                 
                 num = fun_shiny(x = input$SI_X,
                                 y = input$SI_Y,
                                 z = input$SI_Z)
                 
                 
                 #--- CREATE NUMBER IN SERVER ---#
                 output$printvalue <- renderText({
                   
                   paste("The difference between the maximum and the mean of x, y, and z is:", round(num,1))
                   
                 }) # render Text end.
                 
                 
               }) # Observe Event End  
  
  
} # Server end


```

![App with inputs and outputs](Images/Screenshots/Complex model with output.png){width=300 height=300px}  

### Exercise 2: Include a plot as an output on the Shiny app

a) Change title of the main panel to "Basic Plot"

```{r}

#================================================================
#                   Create User Interface
#================================================================

ui <- fluidPage(    # create user interface using fluidpage function
  
  titlePanel("More complex model"),   # title of app
  
  # SIDEBAR
  sidebarLayout(    # indicates layout is going to be a sidebar-layout
    
    sidebarPanel( # open sidebar panel
      
      numericInput(inputId = "SI_X",      # id of input, used in server
                   label = "Number X",  # label next to numeric input
                   value = 200,               # initial value
                   min = 0,                   # minimum value allowed
                   max = 400),                # maximum value allowed
      
      numericInput(inputId = "SI_Y",      # id of input, used in server
                   label = "Number Y",        # label next to numeric input
                   value = 1000,              # initial value
                   min = 0,                   # minimum value allowed
                   max = 400),                # maximum value allowed
      
      sliderInput(inputId = "SI_Z",  # id of input, used in server
                  label = "Number Z",      # label next to numeric input
                  value = 25,                 # initial value
                  min = 10,                   # minimum value allowed
                  max = 80),                  # maximum value allowed
      
      
      actionButton(inputId = "run_model",     # id of action button, used in server
                   label   = "Run model")     # action button label (on button)
      
    ),  # close sidebarPanel
    
    mainPanel(                                # open main panel
      
      h3("Basic plot"),                    # heading (results)                
      
      textOutput(outputId = "printvalue")                    # heading (results table)                
      
      
    ) # close mainpanel    
    
  ) # close sidebarlayout
  
) # close UI fluidpage

```


b) Add a scatter plot with the x input on the X axis and the y input on the Y axis. To do this you will need to use plotOutput() in the user interface function and renderPlot in the server function. (Hint, to create a simple scatter plot, use the plot() function, e.g. plot(x,y)

https://www.rdocumentation.org/packages/graphics/versions/3.6.2/topics/plot)

```{r}

#================================================================
#                   Create User Interface
#================================================================

ui <- fluidPage(    # create user interface using fluidpage function
  
  titlePanel("More complex model"),   # title of app
  
  # SIDEBAR
  sidebarLayout(    # indicates layout is going to be a sidebar-layout
    
    sidebarPanel( # open sidebar panel
      
      numericInput(inputId = "SI_X",      # id of input, used in server
                   label = "Number X",  # label next to numeric input
                   value = 200,               # initial value
                   min = 0,                   # minimum value allowed
                   max = 400),                # maximum value allowed
      
      numericInput(inputId = "SI_Y",      # id of input, used in server
                   label = "Number Y",        # label next to numeric input
                   value = 1000,              # initial value
                   min = 0,                   # minimum value allowed
                   max = 400),                # maximum value allowed
      
      sliderInput(inputId = "SI_Z",  # id of input, used in server
                  label = "Number Z",      # label next to numeric input
                  value = 25,                 # initial value
                  min = 10,                   # minimum value allowed
                  max = 80),                  # maximum value allowed
      
      
      actionButton(inputId = "run_model",     # id of action button, used in server
                   label   = "Run model")     # action button label (on button)
      
    ),  # close sidebarPanel
    
    mainPanel(                                # open main panel
      
      h3("Basic plot"),                    # heading (results)                
      
     plotOutput(outputId = "graph")                    # heading (results table)                
      
      
    ) # close mainpanel    
    
  ) # close sidebarlayout
  
) # close UI fluidpage


#================================================================
#                     Create Server Function
#================================================================

server <- function(input, output){   # server = function with two inputs
  
  
  
  observeEvent(input$run_model,       # when action button pressed ...
               ignoreNULL = F, {
                 
                 num = fun_shiny(x = input$SI_X,
                                 y = input$SI_Y,
                                 z = input$SI_Z)
                 
                 
                 #--- CREATE NUMBER IN SERVER ---#
                 output$graph <- renderPlot({
                    
                   plot(input$SI_X, input$SI_Y)
                   
                 }) # render Text end.
                 
                 
               }) # Observe Event End  
  
  
} # Server end

```

![App with ibasic plot](Images/Screenshots/Exercise 2 b answer.png){width=300 height=300px}  
